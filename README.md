# ๐ฏ Fandom Wiki API (FastAPI)

**Backend ะดะปั ะดะธะฟะปะพะผะฝะพะณะพ ะฟัะพะตะบัะฐ Warhammer 40,000 Fandom Wiki**  
REST API ะดะปั ัะตะณะธัััะฐัะธะธ ะฟะพะปัะทะพะฒะฐัะตะปะตะน, ะฐััะตะฝัะธัะธะบะฐัะธะธ ะธ ะฟะพะปะฝะพะณะพ CRUD ะฟะพ ะฒะธะบะธ-ััะฐัััะผ ะฒะพ ะฒัะตะปะตะฝะฝะพะน Warhammer 40,000.

> โ๏ธ **ะฃัะตะฑะฝัะน ะฝะตะบะพะผะผะตััะตัะบะธะน ะฟัะพะตะบั**. ะัะต ะฟัะฐะฒะฐ ะฝะฐ ะฒัะตะปะตะฝะฝัั Warhammer 40,000 ะฟัะธะฝะฐะดะปะตะถะฐั **Games Workshop**.

---

## ๐ ะกะพะดะตัะถะฐะฝะธะต

- [๐ ะัััััะน ััะฐัั](#-ะฑัััััะน-ััะฐัั)
- [๐ฏ ะงัะพ ััะพ?](#-ััะพ-ััะพ)
- [๐ ะขะตัะฝะพะปะพะณะธะธ](#-ัะตัะฝะพะปะพะณะธะธ)
- [๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ](#-ััััะบัััะฐ-ะฟัะพะตะบัะฐ)
- [โ๏ธ ะะฐัััะพะนะบะฐ ะพะบััะถะตะฝะธั](#๏ธ-ะฝะฐัััะพะนะบะฐ-ะพะบััะถะตะฝะธั)
- [๐ณ ะะฐะฟััะบ ัะตัะตะท Docker](#-ะทะฐะฟััะบ-ัะตัะตะท-docker)
- [๐ ะะพะบะฐะปัะฝัะน ะทะฐะฟััะบ](#-ะปะพะบะฐะปัะฝัะน-ะทะฐะฟััะบ)
- [๐ ะััะตะฝัะธัะธะบะฐัะธั](#-ะฐััะตะฝัะธัะธะบะฐัะธั)
- [๐ก API Endpoints](#-api-endpoints)
- [๐ผ ะะฐะฑะพัะฐ ั ะธะทะพะฑัะฐะถะตะฝะธัะผะธ](#-ัะฐะฑะพัะฐ-ั-ะธะทะพะฑัะฐะถะตะฝะธัะผะธ)
- [๐ ะกะปัะถะตะฑะฝัะต ัะบัะธะฟัั](#-ัะปัะถะตะฑะฝัะต-ัะบัะธะฟัั)
- [๐ ะัะธะผะตัั ะทะฐะฟัะพัะพะฒ](#-ะฟัะธะผะตัั-ะทะฐะฟัะพัะพะฒ)
- [โ FAQ](#-faq)
- [๐ ะะธัะตะฝะทะธั](#-ะปะธัะตะฝะทะธั)

---

## ๐ ะัััััะน ััะฐัั

```bash
# 1. ะะปะพะฝะธัะพะฒะฐะฝะธะต ัะตะฟะพะทะธัะพัะธั
git clone https://github.com/SHR-HR/DIPLOM-fandom-wiki-warhammer40k-API.git
cd DIPLOM-fandom-wiki-warhammer40k-API/API


# 2. ะกะพะทะดะฐัั .env ัะฐะนะป (ะฟะพ ะฟัะธะผะตัั ะธะท README)
# ัะผ. ัะฐะทะดะตะป "ะคะฐะนะป .env" / "ะะฐัััะพะนะบะฐ ะพะบััะถะตะฝะธั"


# 3. ะะฐะฟััะบ ัะตัะตะท Docker Compose
docker compose up -d --build

# 4. ะัะพะฒะตัะบะฐ ัะฐะฑะพัั
curl http://localhost:8000/health
```

**API ะฑัะดะตั ะดะพัััะฟะฝะพ ะฟะพ ะฐะดัะตัั:** `http://localhost:8000`  
**ะะพะบัะผะตะฝัะฐัะธั Swagger:** `http://localhost:8000/docs`

---

## ๐ฏ ะงัะพ ััะพ?

**Fandom Wiki API** โ ััะพ backend-ัะตัะฒะธั, ะบะพัะพััะน:

- โ **ะฅัะฐะฝะธั ะฟะพะปัะทะพะฒะฐัะตะปะตะน ะธ ััะฐััะธ** ะฒะพ ะฒัะตะปะตะฝะฝะพะน Warhammer 40,000
- โ **ะะตะณะธัััะฐัะธั ะธ ะฐััะตะฝัะธัะธะบะฐัะธั** ะฟะพะปัะทะพะฒะฐัะตะปะตะน
- โ **ะะพะปะฝัะน CRUD** ะดะปั ััะฐัะตะน
- โ **ะะฐะฑะพัะฐ ั ะธะทะพะฑัะฐะถะตะฝะธัะผะธ** (ะทะฐะณััะทะบะฐ ัะฐะนะปะพะฒ + ัะพััะฐะฝะตะฝะธะต ะฟะพ URL)
- โ **REST API** ะดะปั ััะพะฝัะตะฝะด-ะฟัะธะปะพะถะตะฝะธั
- โ **JSON-ััะฐะฝะธะปะธัะต** โ ะดะตะผะพ-ัะตะฐะปะธะทะฐัะธั ะดะปั ะดะธะฟะปะพะผะฝะพะณะพ ะฟัะพะตะบัะฐ

---

## ๐ ะขะตัะฝะพะปะพะณะธะธ

| ะขะตัะฝะพะปะพะณะธั | ะะฐะทะฝะฐัะตะฝะธะต |
|------------|------------|
| **Python 3.11+** | ะัะฝะพะฒะฝะพะน ัะทัะบ |
| **FastAPI** | ะะตะฑ-ััะตะนะผะฒะพัะบ |
| **Uvicorn** | ASGI-ัะตัะฒะตั |
| **Docker** | ะะพะฝัะตะนะฝะตัะธะทะฐัะธั |
| **PBKDF2-SHA256** | ะฅะตัะธัะพะฒะฐะฝะธะต ะฟะฐัะพะปะตะน |
| **JSON Files** | ะฅัะฐะฝะตะฝะธะต ะดะฐะฝะฝัั |

**ะะพะปะฝัะน ัะฟะธัะพะบ ะทะฐะฒะธัะธะผะพััะตะน:** `requirements.txt`

---

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
API/
โโโ ๐ app/
โ   โโโ __init__.py
โ   โโโ auth.py              # ๐ ะะตะณะธัััะฐัะธั, ะปะพะณะธะฝ, ะฟัะพัะธะปั
โ   โโโ security.py          # ๐ ะฅะตัะธัะพะฒะฐะฝะธะต ะฟะฐัะพะปะตะน
โ   โโโ utils/
โ       โโโ images.py        # ๐ผ ะะฐะฑะพัะฐ ั ะธะทะพะฑัะฐะถะตะฝะธัะผะธ
โ
โโโ ๐พ data/
โ   โโโ users.json           # ๐ฅ ะะพะปัะทะพะฒะฐัะตะปะธ
โ   โโโ articles.json        # ๐ ะกัะฐััะธ
โ   โโโ uploads/             # ๐ผ ะะฐะณััะถะตะฝะฝัะต ะธะทะพะฑัะฐะถะตะฝะธั
โ
โโโ ๐ tools/
โ   โโโ migrate_users_hashes.py
โ   โโโ fix_articles_authors.py
โ
โโโ ๐ณ Dockerfile
โโโ ๐ฏ docker-compose.yml
โโโ โ๏ธ .env
โโโ ๐ README.md
```

---

## โ๏ธ ะะฐัััะพะนะบะฐ ะพะบััะถะตะฝะธั

### ะะฑัะทะฐัะตะปัะฝัะต ะธะฝััััะผะตะฝัั

| ะะฝััััะผะตะฝั | ะะฐะทะฝะฐัะตะฝะธะต |
|------------|------------|
| **Git** | ะะฐะฑะพัะฐ ั ัะตะฟะพะทะธัะพัะธะตะผ |
| **Docker Desktop** | ะัะฝะพะฒะฝะพะน ัะฟะพัะพะฑ ะทะฐะฟััะบะฐ |
| **REST-ะบะปะธะตะฝั** | Postman, Insomnia ะธะปะธ curl |

### ะคะฐะนะป .env

```env
API_PORT=8000
BACKUP_DIR=./backups
# SEED_ON_EMPTY=1      # ะะฒัะพัะพะทะดะฐะฝะธะต ะดะตะผะพ-ะดะฐะฝะฝัั
```

---

## ๐ณ ะะฐะฟััะบ ัะตัะตะท Docker

### Docker Compose (ัะตะบะพะผะตะฝะดัะตััั)

```bash
# ะะฐะฟััะบ ะฒ ัะพะฝะต
docker compose up -d

# ะะฐะฟััะบ ั ะฟะตัะตัะฑะพัะบะพะน
docker compose up -d --build

# ะัะพัะผะพัั ะปะพะณะพะฒ
docker compose logs -f

# ะััะฐะฝะพะฒะบะฐ
docker compose down
```

### ะััะผะพะน ะทะฐะฟััะบ Docker

```bash
docker build -t fandom-wiki-api .
docker run -p 8000:8000 -v "${PWD}/data:/app/data" fandom-wiki-api
```

**ะะฐ Windows:** ะธัะฟะพะปัะทัะนัะต ัะบัะธะฟั `run_api.ps1`

---

## ๐ ะะพะบะฐะปัะฝัะน ะทะฐะฟััะบ

```bash
# 1. ะกะพะทะดะฐะฝะธะต ะฒะธัััะฐะปัะฝะพะณะพ ะพะบััะถะตะฝะธั
python -m venv venv

# 2. ะะบัะธะฒะฐัะธั (Linux/macOS)
source venv/bin/activate

# 2. ะะบัะธะฒะฐัะธั (Windows PowerShell)
.\venv\Scripts\Activate.ps1

# 3. ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน
pip install -r requirements.txt

# 4. ะะฐะฟััะบ ัะตัะฒะตัะฐ
uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```

---

## ๐ ะััะตะฝัะธัะธะบะฐัะธั

**ะัะฟะพะปัะทัะตััั HTTP Basic Auth**

```http
Authorization: Basic base64(login:password)
```

**ะัะพะฑะตะฝะฝะพััะธ ะฑะตะทะพะฟะฐัะฝะพััะธ:**
- โ ะะฐัะพะปะธ ััะฐะฝัััั ะฒ ะฒะธะดะต ัะตัะตะน (PBKDF2-SHA256)
- โ ะะตั ััะฐะฝะตะฝะธั plaintext-ะฟะฐัะพะปะตะน
- โ ะะฒัะพะผะฐัะธัะตัะบะฐั ะผะธะณัะฐัะธั ััะฐััั ะฟะฐัะพะปะตะน

---

## ๐ก API Endpoints

### ๐ค ะะพะปัะทะพะฒะฐัะตะปะธ

| ะะตัะพะด | Endpoint | ะะฐะทะฝะฐัะตะฝะธะต | Auth |
|-------|----------|------------|------|
| `POST` | `/register` | ะะตะณะธัััะฐัะธั | โ |
| `POST` | `/login` | ะะฒัะพัะธะทะฐัะธั | โ |
| `GET` | `/myProfile` | ะัะพัะธะปั | โ |
| `GET` | `/myArticles` | ะะพะธ ััะฐััะธ | โ |
| `PUT` | `/updateUser` | ะะฑะฝะพะฒะปะตะฝะธะต ะดะฐะฝะฝัั | โ |

### ๐ ะกัะฐััะธ (CRUD)

| ะะตัะพะด | Endpoint           | ะะฐะทะฝะฐัะตะฝะธะต          | Auth |
|-------|--------------------|---------------------|------|
| `GET` | `/articles`        | ะกะฟะธัะพะบ ััะฐัะตะน       | โ   |
| `GET` | `/articles/{id}`   | ะะพะฝะบัะตัะฝะฐั ััะฐััั   | โ   |
| `POST`| `/articles`        | ะกะพะทะดะฐะฝะธะต ััะฐััะธ     | โ   |
| `PATCH` | `/articles/{id}` | ะะฑะฝะพะฒะปะตะฝะธะต ััะฐััะธ   | โ (ัะพะปัะบะพ ะฐะฒัะพั) |
| `DELETE` | `/articles/{id}`| ะฃะดะฐะปะตะฝะธะต ััะฐััะธ     | โ (ัะพะปัะบะพ ะฐะฒัะพั) |


### ๐ผ ะะทะพะฑัะฐะถะตะฝะธั

| ะะตัะพะด | Endpoint | ะะฐะทะฝะฐัะตะฝะธะต |
|-------|----------|------------|
| `POST` | `/upload-image` | ะะฐะณััะทะบะฐ ัะฐะนะปะฐ |
| `POST` | `/images/fromUrl` | ะกะพััะฐะฝะตะฝะธะต ะฟะพ URL |
| `GET` | `/images/proxy` | ะัะพะบัะธ ะฒะฝะตัะฝะธั ะธะทะพะฑัะฐะถะตะฝะธะน |
| `GET` | `/uploads/{path}` | ะะฐะทะดะฐัะฐ ะปะพะบะฐะปัะฝัั ัะฐะนะปะพะฒ |

### ๐ ะกะปัะถะตะฑะฝัะต

| ะะตัะพะด | Endpoint | ะะฐะทะฝะฐัะตะฝะธะต |
|-------|----------|------------|
| `GET` | `/health` | ะัะพะฒะตัะบะฐ ะทะดะพัะพะฒัั |
| `GET` | `/export` | ะญะบัะฟะพัั ะฒัะตั ะดะฐะฝะฝัั |
| `GET` | `/openapi.json` | OpenAPI ััะตะผะฐ |

---

## ๐ผ ะะฐะฑะพัะฐ ั ะธะทะพะฑัะฐะถะตะฝะธัะผะธ

**ะะพะดะดะตัะถะธะฒะฐะตะผัะต ัะพัะผะฐัั:** JPG, JPEG, PNG, WebP, GIF, SVG  
**ะะฐะบัะธะผะฐะปัะฝัะน ัะฐะทะผะตั:** 5 ะะ

**ะัะพะฑะตะฝะฝะพััะธ:**
- โ ะะฒัะพะผะฐัะธัะตัะบะพะต ัะดะฐะปะตะฝะธะต ะฝะตะธัะฟะพะปัะทัะตะผัั ะธะทะพะฑัะฐะถะตะฝะธะน ะฟัะธ ัะดะฐะปะตะฝะธะธ ััะฐััะธ
- โ ะัะพะบัะธัะพะฒะฐะฝะธะต ะฒะฝะตัะฝะธั ะธะทะพะฑัะฐะถะตะฝะธะน
- โ ะะฐะณััะทะบะฐ ะบะฐะบ ัะฐะนะปะพะฒ, ัะฐะบ ะธ ะฟะพ URL

---

## ๐ ะกะปัะถะตะฑะฝัะต ัะบัะธะฟัั

### ะะธะณัะฐัะธั ัะตัะตะน ะฟะฐัะพะปะตะน

```bash
python tools/migrate_users_hashes.py
```
*ะกะพะทะดะฐะตั ัะตะทะตัะฒะฝัั ะบะพะฟะธั ะธ ะทะฐะผะตะฝัะตั plaintext-ะฟะฐัะพะปะธ ะฝะฐ ัะตัะธ*

### ะัะฟัะฐะฒะปะตะฝะธะต ะฐะฒัะพัะพะฒ ััะฐัะตะน

```bash
python tools/fix_articles_authors.py
```
*ะะปั ะผะธะณัะฐัะธะธ ะดะฐะฝะฝัั ะฟะพัะปะต ะธะทะผะตะฝะตะฝะธะน ััััะบัััั*

### ะะตะผะพ-ะดะฐะฝะฝัะต

```bash
python seeds.py
```
*ะะฝะธัะธะฐะปะธะทะฐัะธั ะดะตะผะพ-ะฟะพะปัะทะพะฒะฐัะตะปะตะน ะธ ััะฐัะตะน*

---

## ๐ ะัะธะผะตัั ะทะฐะฟัะพัะพะฒ

### ๐ ะะตะณะธัััะฐัะธั ะฟะพะปัะทะพะฒะฐัะตะปั

```bash
curl -X POST http://localhost:8000/register \
  -H "Content-Type: application/json" \
  -d '{
    "name": "User",
    "login": "user01", 
    "password": "Pa$$w0rd",
    "email": "user@example.com"
  }'
```

### ๐ ะะฒัะพัะธะทะฐัะธั

```bash
curl -X POST http://localhost:8000/login \
  -H "Content-Type: application/json" \
  -d '{
    "login": "user01",
    "password": "Pa$$w0rd"
  }'
```

### ๐ ะกะพะทะดะฐะฝะธะต ััะฐััะธ

```bash
curl -u user01:Pa$$w0rd -X POST http://localhost:8000/articles \
  -H "Content-Type: application/json" \
  -d '{
    "title": "ะะพะฒะฐั ััะฐััั",
    "mainInfo": {
      "name": "ะะผั ะฟะตััะพะฝะฐะถะฐ",
      "age": 25,
      "gender": "ะัะถัะบะพะน",
      "height": 180,
      "weight": 75
    },
    "mainContent": [
      {
        "type": "p", 
        "content": "ะัะธะฒะตั, ะะผะฟะตัะธัะผ!"
      }
    ]
  }'
```

### ๐ผ ะะฐะณััะทะบะฐ ะธะทะพะฑัะฐะถะตะฝะธั

```bash
curl -u user01:Pa$$w0rd -X POST http://localhost:8000/upload-image \
  -F "file=@image.jpg"
```

---

## โ FAQ

### ๐ ะัะพะฑะปะตะผั ั ะฐััะตะฝัะธัะธะบะฐัะธะตะน

**Q:** ะะพะปััะฐั `401 Unauthorized` ะฝะฐ ะทะฐัะธัะตะฝะฝัั ัะฝะดะฟะพะธะฝัะฐั  
**A:** ะฃะฑะตะดะธัะตัั, ััะพ ะฟะตัะตะดะฐะตัะต Basic Auth:
```bash
curl -u login:password http://localhost:8000/myProfile
```

### ๐ ะฃะดะฐะปะตะฝะธะต ะดะฐะฝะฝัั

**Q:** ะงัะพ ะฟัะพะธััะพะดะธั ะฟัะธ ัะดะฐะปะตะฝะธะธ ััะฐััะธ?  
**A:** ะกัะฐััั ัะดะฐะปัะตััั + ะฐะฒัะพะผะฐัะธัะตัะบะธ ะพัะธัะฐัััั ัะฒัะทะฐะฝะฝัะต ะปะพะบะฐะปัะฝัะต ะธะทะพะฑัะฐะถะตะฝะธั

### ๐พ ะฅัะฐะฝะตะฝะธะต ะดะฐะฝะฝัั

**Q:** ะะดะต ััะฐะฝัััั ะดะฐะฝะฝัะต?  
**A:** ะ JSON-ัะฐะนะปะฐั (`data/users.json`, `data/articles.json`) - ะดะตะผะพ-ัะตะฐะปะธะทะฐัะธั

### ๐ณ ะัะพะฑะปะตะผั ั Docker

**Q:** ะะฐะฟะบะฐ `uploads` ะฟัััะฐั ะฟะพัะปะต ะฟะตัะตะทะฐะฟััะบะฐ  
**A:** ะัะพะฒะตัััะต, ััะพ ะฟะฐะฟะบะฐ `data` ะฟัะธะผะพะฝัะธัะพะฒะฐะฝะฐ ะบะฐะบ volume ะฒ Docker

---

## ๐ ะะธัะตะฝะทะธั

**ะฃัะตะฑะฝัะน ะฟัะพะตะบั** โ ะดะธะฟะปะพะผะฝะฐั ัะฐะฑะพัะฐ ะฟะพ ััะพะฝัะตะฝะด/ะฑะตะบะตะฝะด-ัะฐะทัะฐะฑะพัะบะต

> โ๏ธ **ะะฝะธะผะฐะฝะธะต:** ะะต ะฟัะตะดะฝะฐะทะฝะฐัะตะฝ ะดะปั ะฟัะพะดะฐะบัะฝ-ะฝะฐะณััะทะพะบ ะธ ััะฐะฝะตะฝะธั ัะตะฐะปัะฝัั ะฟะตััะพะฝะฐะปัะฝัั ะดะฐะฝะฝัั. ะะตัั ะบะพะฝัะตะฝั ะฒัะตะปะตะฝะฝะพะน Warhammer 40,000 ัะฒะปัะตััั ัะพะฑััะฒะตะฝะฝะพัััั Games Workshop.

---

> **ยซะ ะผัะฐัะฝะพะน ััะผะต ะดะฐะปัะบะพะณะพ ะฑัะดััะตะณะพ ะตััั ัะพะปัะบะพ ะฒะพะนะฝะฐ.ยป**



